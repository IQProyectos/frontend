{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Usuario WTK\\\\Desktop\\\\zzzzzzzzzzzzzzzzzzzzzzzzzz Proyecto 2\\\\frontend\\\\src\\\\pages\\\\Blog\\\\BlogForm.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport { Grid } from '@material-ui/core';\nimport Controls from \"../../components/controls/Controls\";\nimport { useForm, Form } from '../../components/useForm';\nimport { Paper, makeStyles, Box } from '@material-ui/core';\nimport EcoIcon from '@material-ui/icons/Eco';\nimport PageHeader from \"../../components/PageHeader\";\nimport { useParams } from 'react-router-dom';\nimport AlertMessage from '../../components/AlertMessage';\nimport axios from 'axios';\nimport CircularStatic from '../../components/CircularStatic';\nimport ImageComponent from '../../components/ImageComponent';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst initialValues = {\n  name: '',\n  objetivesBlog: '',\n  image: '',\n  projects: []\n};\nconst useStyles = makeStyles(theme => ({\n  pageContent: {\n    margin: '50px 0 0 0',\n    width: '90%',\n    padding: theme.spacing(3)\n  },\n  blogholder: {\n    height: 40,\n    textAlign: 'center',\n    width: '90%'\n  },\n  sizeAvatar: {\n    height: \"150px\",\n    width: \"150px\",\n    marginBottom: \"25px\"\n  },\n  imageButton: {\n    marginBottom: \"25px\"\n  }\n}));\nexport default function BlogForm() {\n  _s();\n\n  const {\n    id\n  } = useParams();\n  const classes = useStyles();\n  const [loading, setLoading] = React.useState(false);\n  const [open, setOpen] = React.useState(false);\n  const [error, setError] = useState('');\n  const message = id ? \"Se ha actualizado el blog!\" : \"Se ha guardado el blog!\";\n  const title = id ? \"Actualizar Bloga\" : \"Añadir nuevo Bloga\";\n  const description = id ? \"Formulario para actualizar Bloga\" : \"Formulario para añadir Bloga\";\n  const [progress, setProgress] = useState(0);\n\n  const validate = (fieldValues = values) => {\n    let temp = { ...errors\n    };\n    if ('name' in fieldValues) temp.name = fieldValues.name ? \"\" : \"Este campo es obligatorio.\";\n    if ('description' in fieldValues) if ('objetivesBlog' in fieldValues) temp.objetivesBlog = fieldValues.objetivesBlog ? \"\" : \"Este campo es obligatorio.\";\n    if ('definitionBlog' in fieldValues) temp.definitionBlog = fieldValues.definitionBlog ? \"\" : \"Este campo es obligatorio.\";\n    setErrors({ ...temp\n    });\n    if (fieldValues === values) return Object.values(temp).every(x => x === \"\");\n  };\n\n  useEffect(() => {\n    let unmounted = false;\n    if (id) getBlog();\n    return () => {\n      unmounted = true;\n    };\n  }, []);\n  const config = {\n    headers: {\n      \"Content-Type\": \"application/json\",\n      Authorization: `Bearer ${localStorage.getItem(\"authToken\")}`\n    },\n    onUploadProgress: data => {\n      //Set the progress value to show the progress bar\n      setProgress(Math.round(100 * data.loaded / data.total));\n    }\n  };\n\n  const getBlog = async () => {\n    setLoading(true);\n\n    try {\n      let response = await axios.get(`http://localhost:5000/api/private/blog/${id}`, {\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${localStorage.getItem(\"authToken\")}`\n        },\n        onDownloadProgress: data => {\n          //Set the progress value to show the progress bar                    \n          setProgress(Math.round(100 * data.loaded / data.total));\n        }\n      });\n      setValues(response.data.blog);\n      setLoading(false);\n    } catch (error) {\n      setTimeout(() => {\n        setOpen(false);\n        setTimeout(() => {\n          setError(\"\");\n        }, 2000);\n      }, 5000);\n      setOpen(true);\n      setLoading(false);\n      return setError(\"Authentication failed!\");\n    }\n  };\n\n  const {\n    values,\n    setValues,\n    errors,\n    setErrors,\n    handleInputChange,\n    resetForm\n  } = useForm(initialValues, true, validate);\n\n  const confirmPost = () => {\n    setOpen(true);\n    setLoading(false);\n\n    if (!id) {\n      console.log(\"create\");\n      resetForm({});\n    }\n\n    setTimeout(function () {\n      setOpen(false);\n    }, 6000);\n  };\n\n  const handleSubmit = async e => {\n    e.preventDefault();\n\n    if (validate()) {\n      setLoading(true);\n\n      try {\n        if (id) {\n          await axios.patch(`http://localhost:5000/api/private/blog/${id}`, values, config).then(confirmPost);\n        } else {\n          await axios.post(\"http://localhost:5000/api/private/blog/\", values, config).then(confirmPost);\n        }\n      } catch (error) {\n        setLoading(false);\n        setTimeout(() => {\n          setTimeout(() => {\n            setError(\"\");\n          }, 2000);\n        }, 5000);\n        return setError(\"Authentication failed!\");\n      }\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(PageHeader, {\n      title: title,\n      subTitle: description,\n      icon: /*#__PURE__*/_jsxDEV(EcoIcon, {\n        fontSize: \"large\",\n        color: \"primary\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 172,\n        columnNumber: 23\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(CircularStatic, {\n      progress: progress,\n      hidden: !loading\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Paper, {\n      className: classes.pageContent,\n      children: [/*#__PURE__*/_jsxDEV(ImageComponent, {\n        initialValues: values,\n        onChange: handleInputChange\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 177,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(Form, {\n        onSubmit: handleSubmit,\n        children: [/*#__PURE__*/_jsxDEV(AlertMessage, {\n          errorMessage: error,\n          successMessage: message,\n          openMessage: open\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 179,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Grid, {\n          container: true,\n          direction: \"row\",\n          justifyContent: \"center\",\n          alignItems: \"center\",\n          style: {\n            textAlign: 'center'\n          },\n          children: [/*#__PURE__*/_jsxDEV(Grid, {\n            item: true,\n            xs: 6,\n            children: [/*#__PURE__*/_jsxDEV(Controls.Input, {\n              name: \"name\",\n              label: \"Nombre\",\n              value: values.name,\n              onChange: handleInputChange,\n              error: errors.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 186,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(Controls.Input, {\n              label: \"Descripci\\xF3n\",\n              name: \"description\",\n              value: values.description,\n              onChange: handleInputChange,\n              error: errors.description\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 193,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 185,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Grid, {\n            item: true,\n            xs: 6,\n            children: [/*#__PURE__*/_jsxDEV(Controls.Input, {\n              name: \"objetivesBlog\",\n              label: \"Objetivos\",\n              value: values.objetivesBlog,\n              onChange: handleInputChange,\n              error: errors.objetivesBlog\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 202,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(Controls.Input, {\n              label: \"Definici\\xF3n principal\",\n              name: \"definitionBlog\",\n              value: values.definitionBlog,\n              onChange: handleInputChange,\n              error: errors.definitionBlog\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 209,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 201,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Grid, {\n            container: true,\n            direction: \"row\",\n            justifyContent: \"center\",\n            alignItems: \"center\",\n            style: {\n              marginTop: '20px'\n            },\n            children: [/*#__PURE__*/_jsxDEV(Controls.Button, {\n              type: \"submit\",\n              text: \"Guardar\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 226,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(Controls.Button, {\n              text: \"Limpiar\",\n              color: \"default\",\n              onClick: resetForm\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 230,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 218,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 180,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 178,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 168,\n    columnNumber: 9\n  }, this);\n}\n\n_s(BlogForm, \"uMiUibnF+Uc+r9YDEHg+HFJ1C2M=\", false, function () {\n  return [useParams, useStyles, useForm];\n});\n\n_c = BlogForm;\n\nvar _c;\n\n$RefreshReg$(_c, \"BlogForm\");","map":{"version":3,"sources":["C:/Users/Usuario WTK/Desktop/zzzzzzzzzzzzzzzzzzzzzzzzzz Proyecto 2/frontend/src/pages/Blog/BlogForm.js"],"names":["React","useState","useEffect","Grid","Controls","useForm","Form","Paper","makeStyles","Box","EcoIcon","PageHeader","useParams","AlertMessage","axios","CircularStatic","ImageComponent","initialValues","name","objetivesBlog","image","projects","useStyles","theme","pageContent","margin","width","padding","spacing","blogholder","height","textAlign","sizeAvatar","marginBottom","imageButton","BlogForm","id","classes","loading","setLoading","open","setOpen","error","setError","message","title","description","progress","setProgress","validate","fieldValues","values","temp","errors","definitionBlog","setErrors","Object","every","x","unmounted","getBlog","config","headers","Authorization","localStorage","getItem","onUploadProgress","data","Math","round","loaded","total","response","get","onDownloadProgress","setValues","blog","setTimeout","handleInputChange","resetForm","confirmPost","console","log","handleSubmit","e","preventDefault","patch","then","post","marginTop"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\r\nimport { Grid } from '@material-ui/core';\r\nimport Controls from \"../../components/controls/Controls\";\r\nimport { useForm, Form } from '../../components/useForm';\r\nimport { Paper, makeStyles, Box } from '@material-ui/core';\r\nimport EcoIcon from '@material-ui/icons/Eco';\r\nimport PageHeader from \"../../components/PageHeader\";\r\nimport { useParams } from 'react-router-dom';\r\nimport AlertMessage from '../../components/AlertMessage';\r\nimport axios from 'axios';\r\nimport CircularStatic from '../../components/CircularStatic'\r\nimport ImageComponent from '../../components/ImageComponent';\r\n\r\nconst initialValues = {\r\n    name: '',\r\n    objetivesBlog: '',\r\n    image: '',\r\n    projects: []\r\n}\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    pageContent: {\r\n        margin: '50px 0 0 0',\r\n        width: '90%',\r\n        padding: theme.spacing(3)\r\n    },\r\n    blogholder: {\r\n        height: 40,\r\n        textAlign: 'center',\r\n        width: '90%'\r\n    },\r\n    sizeAvatar: {\r\n        height: \"150px\",\r\n        width: \"150px\",\r\n        marginBottom: \"25px\",\r\n    },\r\n    imageButton: {\r\n        marginBottom: \"25px\"\r\n    },\r\n}))\r\n\r\nexport default function BlogForm() {\r\n    const { id } = useParams();\r\n    const classes = useStyles();\r\n    const [loading, setLoading] = React.useState(false);\r\n    const [open, setOpen] = React.useState(false);\r\n    const [error, setError] = useState('');\r\n    const message = id ? \"Se ha actualizado el blog!\" : \"Se ha guardado el blog!\"\r\n    const title = id ? \"Actualizar Bloga\" : \"Añadir nuevo Bloga\";\r\n    const description = id ? \"Formulario para actualizar Bloga\" : \"Formulario para añadir Bloga\";\r\n    const [progress, setProgress] = useState(0);\r\n    const validate = (fieldValues = values) => {\r\n        let temp = { ...errors }\r\n        if ('name' in fieldValues)\r\n            temp.name = fieldValues.name ? \"\" : \"Este campo es obligatorio.\"\r\n        if ('description' in fieldValues)\r\n\r\n        if ('objetivesBlog' in fieldValues)\r\n            temp.objetivesBlog = fieldValues.objetivesBlog ? \"\" : \"Este campo es obligatorio.\"\r\n        if ('definitionBlog' in fieldValues)\r\n            temp.definitionBlog = fieldValues.definitionBlog ? \"\" : \"Este campo es obligatorio.\"\r\n        setErrors({\r\n            ...temp\r\n        })\r\n\r\n        if (fieldValues === values)\r\n            return Object.values(temp).every(x => x === \"\")\r\n    }\r\n\r\n    useEffect(() => {\r\n        let unmounted = false;\r\n        if (id)\r\n            getBlog();\r\n        return () => { unmounted = true; };\r\n    }, []);\r\n\r\n    const config = {\r\n        headers: {\r\n            \"Content-Type\": \"application/json\",\r\n            Authorization: `Bearer ${localStorage.getItem(\"authToken\")}`,\r\n        }, onUploadProgress: (data) => {\r\n            //Set the progress value to show the progress bar\r\n            setProgress(Math.round((100 * data.loaded) / data.total));\r\n        },\r\n    };\r\n\r\n    const getBlog = async () => {\r\n        setLoading(true);\r\n        try {\r\n            let response = await axios.get(`http://localhost:5000/api/private/blog/${id}`, {\r\n                headers: {\r\n                    \"Content-Type\": \"application/json\",\r\n                    Authorization: `Bearer ${localStorage.getItem(\"authToken\")}`,\r\n                },\r\n                onDownloadProgress: (data) => {\r\n                    //Set the progress value to show the progress bar                    \r\n                    setProgress(Math.round((100 * data.loaded) / data.total));\r\n                },\r\n            });\r\n            setValues(response.data.blog);\r\n            setLoading(false);\r\n        } catch (error) {\r\n            setTimeout(() => {\r\n                setOpen(false);\r\n                setTimeout(() => {\r\n                    setError(\"\");\r\n                }, 2000);\r\n\r\n            }, 5000);\r\n            setOpen(true);\r\n            setLoading(false);\r\n            return setError(\"Authentication failed!\");\r\n        }\r\n    }\r\n\r\n    const {\r\n        values,\r\n        setValues,\r\n        errors,\r\n        setErrors,\r\n        handleInputChange,\r\n        resetForm\r\n    } = useForm(initialValues, true, validate);\r\n\r\n    const confirmPost = () => {\r\n        setOpen(true);\r\n        setLoading(false);\r\n        if (!id) {\r\n            console.log(\"create\");\r\n            resetForm({});\r\n        }\r\n\r\n        setTimeout(function () {\r\n            setOpen(false);\r\n        }, 6000);\r\n    }\r\n    const handleSubmit = async e => {\r\n        e.preventDefault()\r\n        if (validate()) {\r\n            setLoading(true);\r\n            try {\r\n                if (id) {\r\n                    await axios\r\n                        .patch(`http://localhost:5000/api/private/blog/${id}`, values, config)\r\n                        .then(confirmPost)\r\n                } else {\r\n                    await axios\r\n                        .post(\"http://localhost:5000/api/private/blog/\", values, config)\r\n                        .then(confirmPost)\r\n                }\r\n\r\n            }\r\n\r\n            catch (error) {\r\n                setLoading(false);\r\n                setTimeout(() => {\r\n                    setTimeout(() => {\r\n                        setError(\"\");\r\n                    }, 2000);\r\n                }, 5000);\r\n                return setError(\"Authentication failed!\");\r\n            }\r\n\r\n        }\r\n    }\r\n\r\n    return (\r\n        <div>\r\n            <PageHeader\r\n                title={title}\r\n                subTitle={description}\r\n                icon={<EcoIcon fontSize=\"large\" color='primary'\r\n                />}\r\n            />\r\n            <CircularStatic progress={progress} hidden={!loading} />\r\n            <Paper className={classes.pageContent}>\r\n            <ImageComponent initialValues={values} onChange={handleInputChange}/>\r\n                <Form onSubmit={handleSubmit}>\r\n                    <AlertMessage errorMessage={error} successMessage={message} openMessage={open} />\r\n                    <Grid container\r\n                        direction=\"row\"\r\n                        justifyContent=\"center\"\r\n                        alignItems=\"center\"\r\n                        style={{ textAlign: 'center' }}>\r\n                        <Grid item xs={6}>\r\n                            <Controls.Input\r\n                                name=\"name\"\r\n                                label=\"Nombre\"\r\n                                value={values.name}\r\n                                onChange={handleInputChange}\r\n                                error={errors.name}\r\n                            />\r\n                            <Controls.Input\r\n                                label=\"Descripción\"\r\n                                name=\"description\"\r\n                                value={values.description}\r\n                                onChange={handleInputChange}\r\n                                error={errors.description}\r\n                            />\r\n                        </Grid>\r\n                        <Grid item xs={6}>\r\n                            <Controls.Input\r\n                                name=\"objetivesBlog\"\r\n                                label=\"Objetivos\"\r\n                                value={values.objetivesBlog}\r\n                                onChange={handleInputChange}\r\n                                error={errors.objetivesBlog}\r\n                            />\r\n                            <Controls.Input\r\n                                label=\"Definición principal\"\r\n                                name=\"definitionBlog\"\r\n                                value={values.definitionBlog}\r\n                                onChange={handleInputChange}\r\n                                error={errors.definitionBlog}\r\n                            />\r\n                        </Grid>\r\n\r\n                        <Grid\r\n                            container\r\n                            direction=\"row\"\r\n                            justifyContent=\"center\"\r\n                            alignItems=\"center\"\r\n                            style={{ marginTop: '20px' }}\r\n                        >\r\n\r\n                            <Controls.Button\r\n                                type=\"submit\"\r\n                                text=\"Guardar\"\r\n                            />\r\n                            <Controls.Button\r\n                                text=\"Limpiar\"\r\n                                color=\"default\"\r\n                                onClick={resetForm} />\r\n                        </Grid>\r\n                    </Grid>\r\n                </Form>\r\n            </Paper>\r\n        </div>\r\n    )\r\n}\r\n"]},"metadata":{},"sourceType":"module"}